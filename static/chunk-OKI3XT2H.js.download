import{f as Y,g as G,h as z,m,n as u,v as R}from"./chunk-DNOI7M3U.js";var _e={};z(_e,{useCallback:()=>$,useContext:()=>ee,useDebugValue:()=>te,useEffect:()=>K,useErrorBoundary:()=>ne,useId:()=>ie,useImperativeHandle:()=>Z,useLayoutEffect:()=>U,useMemo:()=>W,useReducer:()=>q,useRef:()=>Q,useState:()=>V});function p(n,e){u.__h&&u.__h(a,n,w||e),w=0;var t=a.__H||(a.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({__V:T}),t.__[n]}function V(n){return w=1,q(j,n)}function q(n,e,t){var o=p(v++,2);if(o.t=n,!o.__c&&(o.__=[t?t(e):j(void 0,e),function(b){var k=o.__N?o.__N[0]:o.__[0],s=o.t(k,b);k!==s&&(o.__N=[s,o.__[1]],o.__c.setState({}))}],o.__c=a,!a.u)){a.u=!0;var _=a.shouldComponentUpdate;a.shouldComponentUpdate=function(b,k,s){if(!o.__c.__H)return!0;var r=o.__c.__H.__.filter(function(h){return h.__c});if(r.every(function(h){return!h.__N}))return!_||_.call(this,b,k,s);var d=!1;return r.forEach(function(h){if(h.__N){var y=h.__[0];h.__=h.__N,h.__N=void 0,y!==h.__[0]&&(d=!0)}}),!(!d&&o.__c.props===b)&&(!_||_.call(this,b,k,s))}}return o.__N||o.__}function K(n,e){var t=p(v++,3);!u.__s&&D(t.__H,e)&&(t.__=n,t.i=e,a.__H.__h.push(t))}function U(n,e){var t=p(v++,4);!u.__s&&D(t.__H,e)&&(t.__=n,t.i=e,a.__h.push(t))}function Q(n){return w=5,W(function(){return{current:n}},[])}function Z(n,e,t){w=6,U(function(){return typeof n=="function"?(n(e()),function(){return n(null)}):n?(n.current=e(),function(){return n.current=null}):void 0},t==null?t:t.concat(n))}function W(n,e){var t=p(v++,7);return D(t.__H,e)?(t.__V=n(),t.i=e,t.__h=n,t.__V):t.__}function $(n,e){return w=8,W(function(){return n},e)}function ee(n){var e=a.context[n.__c],t=p(v++,9);return t.c=n,e?(t.__==null&&(t.__=!0,e.sub(a)),e.props.value):n.__}function te(n,e){u.useDebugValue&&u.useDebugValue(e?e(n):n)}function ne(n){var e=p(v++,10),t=V();return e.__=n,a.componentDidCatch||(a.componentDidCatch=function(o,_){e.__&&e.__(o,_),t[1](o)}),[t[0],function(){t[1](void 0)}]}function ie(){var n=p(v++,11);if(!n.__){for(var e=a.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);n.__="P"+t[0]+"-"+t[1]++}return n.__}function oe(){for(var n;n=B.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(E),n.__H.__h.forEach(S),n.__H.__h=[]}catch(e){n.__H.__h=[],u.__e(e,n.__v)}}function ce(n){var e,t=function(){clearTimeout(o),L&&cancelAnimationFrame(e),setTimeout(n)},o=setTimeout(t,100);L&&(e=requestAnimationFrame(t))}function E(n){var e=a,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),a=e}function S(n){var e=a;n.__c=n.__(),a=e}function D(n,e){return!n||n.length!==e.length||e.some(function(t,o){return t!==n[o]})}function j(n,e){return typeof e=="function"?e(n):e}var v,a,P,H,w,B,T,I,N,O,x,F,L,se=Y(()=>{m();R();w=0,B=[],T=[],I=u.__b,N=u.__r,O=u.diffed,x=u.__c,F=u.unmount;u.__b=function(n){a=null,I&&I(n)},u.__r=function(n){N&&N(n),v=0;var e=(a=n.__c).__H;e&&(P===a?(e.__h=[],a.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=T,t.__N=t.i=void 0})):(e.__h.forEach(E),e.__h.forEach(S),e.__h=[])),P=a},u.diffed=function(n){O&&O(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(B.push(e)!==1&&H===u.requestAnimationFrame||((H=u.requestAnimationFrame)||ce)(oe)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==T&&(t.__=t.__V),t.i=void 0,t.__V=T})),P=a=null},u.__c=function(n,e){e.some(function(t){try{t.__h.forEach(E),t.__h=t.__h.filter(function(o){return!o.__||S(o)})}catch(o){e.some(function(_){_.__h&&(_.__h=[])}),e=[],u.__e(o,t.__v)}}),x&&x(n,e)},u.unmount=function(n){F&&F(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(o){try{E(o)}catch(_){e=_}}),t.__H=void 0,e&&u.__e(e,t.__v))};L=typeof requestAnimationFrame=="function"});var ue=G((C,M)=>{m();(function(e,t){typeof C=="object"&&typeof M=="object"?M.exports=t():typeof define=="function"&&define.amd?define("persistentwebsocket",[],t):typeof C=="object"?C.persistentwebsocket=t():e.persistentwebsocket=t()})(C,function(){return function(n){var e={};function t(o){if(e[o])return e[o].exports;var _=e[o]={i:o,l:!1,exports:{}};return n[o].call(_.exports,_,_.exports,t),_.l=!0,_.exports}return t.m=n,t.c=e,t.i=function(o){return o},t.d=function(o,_,b){t.o(o,_)||Object.defineProperty(o,_,{configurable:!1,enumerable:!0,get:b})},t.n=function(o){var _=o&&o.__esModule?function(){return o.default}:function(){return o};return t.d(_,"a",_),_},t.o=function(o,_){return Object.prototype.hasOwnProperty.call(o,_)},t.p="",t(t.s=16)}({1:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function s(r,d){for(var h=0;h<d.length;h++){var y=d[h];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(r,y.key,y)}}return function(r,d,h){return d&&s(r.prototype,d),h&&s(r,h),r}}();function _(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function b(s,r){return Math.floor(Math.random()*(r-s))+s}var k=function(){function s(r,d){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b;_(this,s),this._initialDelay=r,this._maxDelay=d,this._nextDelay=this._initialDelay,this._randomBetween=h}return o(s,[{key:"reset",value:function(){this._nextDelay=this._initialDelay}},{key:"nextDelay",value:function(){var d=this._nextDelay;return this._nextDelay=Math.min(this._maxDelay,this._randomBetween(this._initialDelay,d*3)),d}}]),s}();e.default=k,n.exports=e.default},16:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PersistentWebsocket=e.AttemptReconnectEvent=e.READYSTATE=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},_=function(){function l(c,i){for(var f=0;f<i.length;f++){var g=i[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(c,g.key,g)}}return function(c,i,f){return i&&l(c.prototype,i),f&&l(c,f),c}}(),b=t(1),k=s(b);function s(l){return l&&l.__esModule?l:{default:l}}function r(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var d=e.READYSTATE={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},h={debug:!1,initialBackoffDelayMillis:500,maxBackoffDelayMillis:12e4,pingSendFunction:null,pingIntervalSeconds:30,pingTimeoutMillis:2e3,connectTimeoutMillis:3e3,reachabilityTestUrl:null};function y(){}var X=e.AttemptReconnectEvent=function l(c,i){r(this,l),this.attemptNumber=c,this.waitMillis=i},ae=e.PersistentWebsocket=function(){function l(c,i){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r(this,l),(typeof i=="undefined"?"undefined":o(i))==="object"&&(f=i,i=void 0),this.onopen=y,this.onclose=y,this.onmessage=y,this.onerror=y,this.onbeforereconnect=y,this._url=c,this._protocols=i,this._options=Object.assign({},h,f),this._backoff=new k.default(this._options.initialBackoffDelayMillis,this._options.maxBackoffDelayMillis),this._waitingForPong=!1,this._manuallyClosed=!1,this._hasConnected=!1,this._retryCount=0,this._pingTimeoutId=0,this._scheduledReconnectTimeoutId=0,this._websocketConnectionCheckTimeoutId=0,this._reachabilityCheckTimeoutId=0}return _(l,[{key:"_createWebsocket",value:function(i,f){return new WebSocket(i,f)}},{key:"_createXhr",value:function(){return new XMLHttpRequest}},{key:"_openWebsocket",value:function(){this._debugLog("Trying to open websocket");var i=this._createWebsocket(this._url,this._protocols);this._binaryType&&(i.binaryType=this._binaryType),i.onclose=this._onWebsocketClose.bind(this),i.onerror=this._onWebsocketError.bind(this),i.onmessage=this._onWebsocketMessage.bind(this),i.onopen=this._onWebsocketOpen.bind(this),this._websocket=i,this._scheduleWebsocketConnectionCheck()}},{key:"_onWebsocketClose",value:function(i){i.wasExpected=this._manuallyClosed,this.onclose(i),this._manuallyClosed||this._checkReachabilityAndScheduleReconnect()}},{key:"_onWebsocketError",value:function(i){this.onerror(i)}},{key:"_onWebsocketMessage",value:function(i){this._waitingForPong=!1,this._schedulePing(),this.onmessage(i)}},{key:"_onWebsocketOpen",value:function(i){i.wasReconnect=this._hasConnected,this.onopen(i),this._hasConnected=!0,this._retryCount=0,i.target.readyState==d.OPEN&&(this._schedulePing(),this._cancelWebsocketConnectionCheck())}},{key:"_sendPing",value:function(){this._debugLog("Pinging websocket..."),this._waitingForPong=!0,this._options.pingSendFunction(this),setTimeout(this._checkPingResult.bind(this),this._options.pingTimeoutMillis)}},{key:"_schedulePing",value:function(){this._pingTimeoutId&&this._cancelPing();var i=this._options,f=i.pingSendFunction,g=i.pingIntervalSeconds;f&&g&&(this._pingTimeoutId=setTimeout(this._sendPing.bind(this),g*1e3))}},{key:"_cancelPing",value:function(){clearTimeout(this._pingTimeoutId),this._pingTimeoutId=0}},{key:"_checkPingResult",value:function(){this._waitingForPong&&(this._debugLog("Closing websocket due to ping failure."),this._websocket.close(4001,"Closing websocket due to ping failure."))}},{key:"_checkReachabilityAndScheduleReconnect",value:function(){var i=this;if(!this._options.reachabilityTestUrl)this._scheduleReconnect();else{var f=this._createXhr();f.addEventListener("load",function(){i._reachabilityCheckTimeoutId=0,i._debugLog("ONLINE: HEAD request to "+i._options.reachabilityTestUrl+" succeeded."),i._scheduleReconnect()}),f.addEventListener("error",function(){i._debugLog("OFFLINE: Unable to reach "+i._options.reachabilityTestUrl+`.
Trying again in 3s.`),i._backoff.reset(),i._reachabilityCheckTimeoutId=setTimeout(i._checkReachabilityAndScheduleReconnect.bind(i),3e3)}),f.open("HEAD",this._options.reachabilityTestUrl),f.send()}}},{key:"_cancelReachabilityCheck",value:function(){this._reachabilityCheckTimeoutId&&(clearTimeout(this._reachabilityCheckTimeoutId),this._reachabilityCheckTimeoutId=0)}},{key:"_scheduleReconnect",value:function(){var i=this._backoff.nextDelay();this._retryCount++,this._debugLog("Scheduling websocket reconnect attempt "+this._retryCount+" in "+i+"ms"),this.onbeforereconnect(new X(this._retryCount,i)),this._scheduledReconnectTimeoutId=setTimeout(this._openWebsocket.bind(this),i)}},{key:"_cancelScheduledReconnect",value:function(){this._scheduledReconnectTimeoutId&&(clearTimeout(this._scheduledReconnectTimeoutId),this._scheduledReconnectTimeoutId=0)}},{key:"_scheduleWebsocketConnectionCheck",value:function(){setTimeout(this._checkWebsocketConnection.bind(this),this._options.connectTimeoutMillis)}},{key:"_cancelWebsocketConnectionCheck",value:function(){this._websocketConnectionCheckTimeoutId&&(clearTimeout(this._websocketConnectionCheckTimeoutId),this._websocketConnectionCheckTimeoutId=0)}},{key:"_checkWebsocketConnection",value:function(){this._debugLog("Checking websocket connection. ReadyState is "+this._websocket.readyState),this._websocket.readyState===d.OPEN?this._schedulePing():this._websocket.close(4e3,"Unable to establish websocket connection before the configured connectTimeoutMillis")}},{key:"_debugLog",value:function(i){this._options.debug&&console.debug(i)}},{key:"open",value:function(){if(this._websocket)throw"Websocket has already been opened";this._openWebsocket()}},{key:"close",value:function(i,f){if(this._manuallyClosed=!0,this._cancelScheduledReconnect(),this._cancelWebsocketConnectionCheck(),this._cancelReachabilityCheck(),this._cancelPing(),!this._websocket)throw"Can't close websocket because it was never opened.";this._websocket.close(i,f)}},{key:"send",value:function(i){if(!this._websocket)throw"Can't send through websocket because it was never opened.";this._websocket.send(i)}},{key:"readyState",get:function(){if(!this._websocket)throw"Can't get websocket readyState because it was never opened.";return this._websocket.readyState}},{key:"url",get:function(){return this._url}},{key:"bufferedAmount",get:function(){if(!this._websocket)throw"Can't get websocket bufferedAmount because it was never opened.";return this._websocket.bufferedAmount}},{key:"extensions",get:function(){if(!this._websocket)throw"Can't get websocket extensions because it was never opened.";return this._websocket.extensions}},{key:"binaryType",get:function(){return this._binaryType},set:function(i){this._binaryType=i,this._websocket&&(this._websocket.binaryType=i)}},{key:"retryCount",get:function(){return this._retryCount}}]),l}()}})})});m();R();R();var J=0;function he(n,e,t,o,_,b){var k,s,r={};for(s in e)s=="ref"?k=e[s]:r[s]=e[s];var d={type:n,props:r,key:t,ref:k,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--J,__source:_,__self:b};if(typeof n=="function"&&(k=n.defaultProps))for(s in k)r[s]===void 0&&(r[s]=k[s]);return u.vnode&&u.vnode(d),d}export{V as a,q as b,K as c,Q as d,W as e,$ as f,ee as g,ne as h,_e as i,se as j,ue as k,he as l};
